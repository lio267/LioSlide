# MCP ë„êµ¬ í†µí•© ê°€ì´ë“œ

> ì´ ë¬¸ì„œëŠ” PPT ìë™ ìƒì„±ê¸°ì—ì„œ MCP ë„êµ¬ë“¤ì„ íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ¯ ê°œìš”

MCP(Model Context Protocol) ë„êµ¬ë“¤ì€ íŒŒì´í”„ë¼ì¸ì˜ ê° ë‹¨ê³„ì—ì„œ íŠ¹ì • ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sequence        â”‚     â”‚ Context7        â”‚     â”‚ Chrome          â”‚
â”‚ Thinking        â”‚     â”‚                 â”‚     â”‚ DevTools        â”‚
â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚
â”‚ â€¢ ì•„ì›ƒë¼ì¸ ìƒì„±  â”‚     â”‚ â€¢ API ë¬¸ì„œ ì°¸ì¡°  â”‚     â”‚ â€¢ ë ˆì´ì•„ì›ƒ ê²€ì‚¬  â”‚
â”‚ â€¢ íë¦„ ì„¤ê³„     â”‚     â”‚ â€¢ ì œì•½ í™•ì¸      â”‚     â”‚ â€¢ ì˜¤ë²„í”Œë¡œìš° íƒì§€â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PPT ìƒì„± íŒŒì´í”„ë¼ì¸                          â”‚
â”‚  Outline â†’ SpecBuilder â†’ Layout â†’ Render â†’ StyleGuardian       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                               â”‚
         â–¼                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub          â”‚                             â”‚ ì¶œë ¥            â”‚
â”‚                 â”‚                             â”‚                 â”‚
â”‚ â€¢ í…œí”Œë¦¿ ì €ì¥   â”‚                             â”‚ â€¢ .pptx         â”‚
â”‚ â€¢ ë²„ì „ ê´€ë¦¬    â”‚                             â”‚ â€¢ slidespec.jsonâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Sequence Thinking (ì”¨í€€ìŠ¤ëµí‚¹)

### ì—­í• 
- **ì£¼ ìš©ë„**: Outline Agentì—ì„œ ìŠ¬ë¼ì´ë“œ ëª©ì°¨ ë° íë¦„ ìƒì„±
- **í•µì‹¬ ê°€ì¹˜**: "ìŠ¬ë¼ì´ë“œë³„ í•œ ë¬¸ì¥ ë©”ì‹œì§€"ë¥¼ ë¨¼ì € ë½‘ì•„ í’ˆì§ˆ ê¸‰ìƒìŠ¹

### ì‚¬ìš© ì‹œì 
```typescript
// src/agents/outlineAgent.ts
import { useSequenceThinking } from '@mcp/sequence-thinking';

async function generateOutline(input: UserInput): Promise<OutlineAgentOutput> {
  const thinking = useSequenceThinking();
  
  // Step 1: í•µì‹¬ ë©”ì‹œì§€ ì¶”ì¶œ
  const keyMessages = await thinking.analyze({
    input: input.sourceContent,
    task: 'extract_key_points',
    constraints: {
      maxPoints: input.slideCount,
      style: input.tone,
    }
  });
  
  // Step 2: íë¦„ ìµœì í™”
  const optimizedFlow = await thinking.sequence({
    items: keyMessages,
    criteria: ['logical_flow', 'audience_engagement', 'time_allocation'],
  });
  
  // Step 3: ìŠ¬ë¼ì´ë“œ íƒ€ì… ê²°ì •
  const outline = optimizedFlow.map((msg, i) => ({
    order: i,
    type: determineSlideType(msg),
    title: msg.title,
    keyMessage: msg.summary, // í•œ ë¬¸ì¥!
    contentHints: msg.supportingPoints,
    estimatedDensity: msg.contentDensity,
  }));
  
  return {
    outline,
    totalSlides: outline.length,
    sections: groupIntoSections(outline),
    thinkingLog: thinking.getLog(),
  };
}
```

### í”„ë¡¬í”„íŠ¸ íŒ¨í„´
```typescript
const OUTLINE_PROMPT = `
ë‹¹ì‹ ì€ í”„ë ˆì  í…Œì´ì…˜ êµ¬ì¡° ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì…ë ¥: {sourceContent}
ëŒ€ìƒ: {audience}
í†¤: {tone}
ìŠ¬ë¼ì´ë“œ ìˆ˜: {slideCount}

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ê° ìŠ¬ë¼ì´ë“œì˜ í•µì‹¬ ë©”ì‹œì§€ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”:

ìŠ¬ë¼ì´ë“œ 1: [í•œ ë¬¸ì¥ í•µì‹¬ ë©”ì‹œì§€]
- ì§€ì› í¬ì¸íŠ¸ 1
- ì§€ì› í¬ì¸íŠ¸ 2

ê·œì¹™:
1. ê° ìŠ¬ë¼ì´ë“œëŠ” í•˜ë‚˜ì˜ ëª…í™•í•œ ë©”ì‹œì§€ë§Œ ì „ë‹¬
2. ë©”ì‹œì§€ëŠ” ì²­ì¤‘ì´ ê¸°ì–µí•´ì•¼ í•  ê²ƒ
3. íë¦„ì´ ë…¼ë¦¬ì ìœ¼ë¡œ ì—°ê²°ë˜ì–´ì•¼ í•¨
`;
```

---

## 2. Context7 (ì»¨í…ìŠ¤íŠ¸7)

### ì—­í• 
- **ì£¼ ìš©ë„**: pptxgenjs API ë¬¸ì„œ ë° ì œì•½ ì‚¬í•­ ì°¸ì¡°
- **í•µì‹¬ ê°€ì¹˜**: "ê°€ëŠ¥/ë¶ˆê°€ëŠ¥"ì„ ë¬¸ì„œ ê¸°ë°˜ìœ¼ë¡œ í™•ì •í•˜ì—¬ í™˜ê° ë°©ì§€

### ì‚¬ìš© ì‹œì 
```typescript
// src/renderer/pptxRenderer.ts
import { useContext7 } from '@mcp/context7';

async function validateRenderCapability(
  block: ContentBlock
): Promise<{ supported: boolean; constraints?: string[] }> {
  const ctx = useContext7();
  
  // pptxgenjs ë¬¸ì„œì—ì„œ í•´ë‹¹ ê¸°ëŠ¥ í™•ì¸
  const capability = await ctx.query({
    library: 'pptxgenjs',
    feature: block.type,
    version: '3.x',
  });
  
  if (!capability.supported) {
    return {
      supported: false,
      constraints: capability.alternatives,
    };
  }
  
  return {
    supported: true,
    constraints: capability.limitations,
  };
}
```

### ìºì‹œ ì „ëµ
```typescript
// ìì£¼ ì¡°íšŒí•˜ëŠ” ì œì•½ ì‚¬í•­ ìºì‹œ
const API_CONSTRAINTS_CACHE = {
  fonts: ['Arial', 'Helvetica', 'Times New Roman', ...], // web-safeë§Œ
  chartTypes: ['bar', 'line', 'pie', 'doughnut', 'area'],
  colorFormat: 'hex without #',
  maxSlides: 500,
  maxTextLength: 10000,
};

// Context7ë¡œ ìºì‹œ ê°±ì‹ 
async function refreshConstraintsCache() {
  const ctx = useContext7();
  
  const latest = await ctx.getDocumentation({
    library: 'pptxgenjs',
    sections: ['fonts', 'charts', 'limitations'],
  });
  
  Object.assign(API_CONSTRAINTS_CACHE, latest);
}
```

### ë¬¸ì„œ ì°¸ì¡° ì˜ˆì‹œ
```typescript
// ì°¨íŠ¸ ì œì•½ í™•ì¸
const chartConstraints = await ctx.query({
  library: 'pptxgenjs',
  feature: 'charts',
  question: 'What are the limitations of pie charts?',
});

// ê²°ê³¼: { maxDataPoints: 50, requiresSingleSeries: true, ... }
```

---

## 3. GitHub MCP

### ì—­í• 
- **ì£¼ ìš©ë„**: í…œí”Œë¦¿(í…Œë§ˆ) ì €ì¥ ë° ë²„ì „ ê´€ë¦¬
- **í•µì‹¬ ê°€ì¹˜**: ì‚¬ë‚´ ìŠ¤íƒ€ì¼ í…œí”Œë¦¿ì„ ì¤‘ì•™ ì €ì¥ì†Œì—ì„œ ê´€ë¦¬

### ì €ì¥ì†Œ êµ¬ì¡°
```
ppt-templates/
â”œâ”€â”€ themes/
â”‚   â”œâ”€â”€ corporate/
â”‚   â”‚   â”œâ”€â”€ blue.json
â”‚   â”‚   â”œâ”€â”€ green.json
â”‚   â”‚   â””â”€â”€ dark.json
â”‚   â”œâ”€â”€ creative/
â”‚   â”‚   â”œâ”€â”€ bold.json
â”‚   â”‚   â””â”€â”€ minimal.json
â”‚   â””â”€â”€ custom/
â”‚       â””â”€â”€ {company-name}.json
â”œâ”€â”€ layouts/
â”‚   â”œâ”€â”€ title-slides/
â”‚   â”œâ”€â”€ content-slides/
â”‚   â””â”€â”€ chart-slides/
â””â”€â”€ examples/
    â””â”€â”€ sample-decks/
```

### ì‚¬ìš© ì‹œì 
```typescript
// src/utils/themeLoader.ts
import { useGitHub } from '@mcp/github';

async function loadTheme(themeName: string): Promise<Theme> {
  const gh = useGitHub();
  
  // ë ˆí¬ì—ì„œ í…Œë§ˆ JSON ë¡œë“œ
  const themeFile = await gh.getFile({
    repo: 'company/ppt-templates',
    path: `themes/${themeName}.json`,
    ref: 'main', // ë˜ëŠ” íŠ¹ì • ë²„ì „ íƒœê·¸
  });
  
  const theme = JSON.parse(themeFile.content);
  
  // zodë¡œ ê²€ì¦
  return ThemeSchema.parse(theme);
}

async function saveCustomTheme(theme: Theme): Promise<void> {
  const gh = useGitHub();
  
  await gh.createOrUpdateFile({
    repo: 'company/ppt-templates',
    path: `themes/custom/${theme.name}.json`,
    content: JSON.stringify(theme, null, 2),
    message: `Add/Update theme: ${theme.name}`,
    branch: 'main',
  });
}
```

### ë²„ì „ ê´€ë¦¬
```typescript
// íŠ¹ì • ë²„ì „ì˜ í…Œë§ˆ ë¡œë“œ
const theme = await loadTheme('corporate-blue', { version: 'v2.1.0' });

// í…Œë§ˆ ë³€ê²½ ì´ë ¥ ì¡°íšŒ
const history = await gh.getCommitHistory({
  repo: 'company/ppt-templates',
  path: 'themes/corporate-blue.json',
  limit: 10,
});
```

---

## 4. Chrome DevTools MCP

### ì—­í• 
- **ì£¼ ìš©ë„**: HTML í”„ë¦¬ë·° ìº”ë²„ìŠ¤ì—ì„œ ë ˆì´ì•„ì›ƒ ë””ë²„ê¹…
- **í•µì‹¬ ê°€ì¹˜**: ë°•ìŠ¤ ì¢Œí‘œ/ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸ í›„ PPTXì— ë™ì¼ ì ìš©

### ì›Œí¬í”Œë¡œìš°
```
1. SlideSpec â†’ HTML í”„ë¦¬ë·° ìƒì„±
2. Chrome DevToolsë¡œ ë ˆì´ì•„ì›ƒ ê²€ì‚¬
3. ì˜¤ë²„í”Œë¡œìš°/ì •ë ¬ ë¬¸ì œ íƒì§€
4. ìˆ˜ì • í›„ PPTX ë Œë”ë§
```

### ì‚¬ìš© ì‹œì 
```typescript
// src/engine/layout/debugger.ts
import { useChromeDevTools } from '@mcp/chrome-devtools';

async function debugLayout(
  layoutResult: LayoutResult,
  htmlPreviewPath: string
): Promise<LayoutDebugReport> {
  const devtools = useChromeDevTools();
  
  // HTML í”„ë¦¬ë·° ì—´ê¸°
  await devtools.open(htmlPreviewPath);
  
  // ëª¨ë“  ìŠ¬ë¼ì´ë“œ ë°•ìŠ¤ ê²€ì‚¬
  const inspections = await Promise.all(
    layoutResult.slides.map(async (slide, i) => {
      // ìŠ¬ë¼ì´ë“œë¡œ ì´ë™
      await devtools.navigateTo(`#slide-${i}`);
      
      // ë°•ìŠ¤ ê²€ì‚¬
      const boxes = await devtools.inspectElements({
        selector: '.content-block',
        properties: ['boundingBox', 'overflow', 'computedStyle'],
      });
      
      return {
        slideIndex: i,
        boxes,
        overflows: boxes.filter(b => b.overflow !== 'visible'),
        alignmentIssues: checkAlignment(boxes),
      };
    })
  );
  
  return {
    slides: inspections,
    hasIssues: inspections.some(s => s.overflows.length > 0),
  };
}
```

### ì˜¤ë²„í”Œë¡œìš° íƒì§€
```typescript
async function detectOverflow(slideIndex: number): Promise<OverflowInfo[]> {
  const devtools = useChromeDevTools();
  
  // ì˜¤ë²„í”Œë¡œìš°ëœ ìš”ì†Œ ì°¾ê¸°
  const overflowed = await devtools.evaluateScript(`
    Array.from(document.querySelectorAll('#slide-${slideIndex} .content-block'))
      .filter(el => {
        const rect = el.getBoundingClientRect();
        const parent = el.parentElement.getBoundingClientRect();
        return (
          rect.right > parent.right ||
          rect.bottom > parent.bottom
        );
      })
      .map(el => ({
        id: el.id,
        overflow: {
          right: Math.max(0, el.getBoundingClientRect().right - el.parentElement.getBoundingClientRect().right),
          bottom: Math.max(0, el.getBoundingClientRect().bottom - el.parentElement.getBoundingClientRect().bottom),
        }
      }))
  `);
  
  return overflowed;
}
```

### ì‹œê°ì  ë””ë²„ê¹…
```typescript
// ë ˆì´ì•„ì›ƒ ê·¸ë¦¬ë“œ ì˜¤ë²„ë ˆì´
await devtools.injectStyles(`
  .content-block {
    outline: 1px solid rgba(255, 0, 0, 0.3);
  }
  .slide-grid {
    background: 
      linear-gradient(90deg, rgba(0,0,255,0.1) 1px, transparent 1px),
      linear-gradient(rgba(0,0,255,0.1) 1px, transparent 1px);
    background-size: calc(100% / 12) 8pt;
  }
`);

// ë§ˆì§„ ì˜ì—­ í‘œì‹œ
await devtools.injectStyles(`
  .safe-margin {
    border: 2px dashed rgba(255, 0, 0, 0.5);
  }
  .readable-margin {
    border: 1px dashed rgba(0, 255, 0, 0.5);
  }
`);
```

---

## ğŸ”„ MCP í†µí•© íŒŒì´í”„ë¼ì¸ ì˜ˆì‹œ

```typescript
// src/pipeline/generatePresentation.ts
import { useSequenceThinking } from '@mcp/sequence-thinking';
import { useContext7 } from '@mcp/context7';
import { useGitHub } from '@mcp/github';
import { useChromeDevTools } from '@mcp/chrome-devtools';

async function generatePresentation(input: UserInput): Promise<string> {
  const thinking = useSequenceThinking();
  const ctx7 = useContext7();
  const gh = useGitHub();
  const devtools = useChromeDevTools();
  
  // 1. í…Œë§ˆ ë¡œë“œ (GitHub)
  const theme = await gh.getFile({
    repo: 'company/ppt-templates',
    path: `themes/${input.branding?.template || 'default'}.json`,
  });
  
  // 2. ì•„ì›ƒë¼ì¸ ìƒì„± (Sequence Thinking)
  const outline = await thinking.analyze({
    content: input.sourceContent,
    format: 'presentation_outline',
  });
  
  // 3. API ì œì•½ í™•ì¸ (Context7)
  const constraints = await ctx7.query({
    library: 'pptxgenjs',
    features: outline.requiredFeatures,
  });
  
  // 4. ìŠ¤í™ ë¹Œë“œ
  const spec = buildSpec(outline, theme, constraints);
  
  // 5. ë ˆì´ì•„ì›ƒ ê³„ì‚°
  const layout = calculateLayout(spec, theme);
  
  // 6. HTML í”„ë¦¬ë·° ìƒì„± ë° ë””ë²„ê¹… (Chrome DevTools)
  const previewPath = await generateHTMLPreview(spec, layout);
  const debugReport = await devtools.inspect(previewPath);
  
  if (debugReport.hasIssues) {
    // ì´ìŠˆ ìˆ˜ì • í›„ ì¬ê³„ì‚°
    const fixedSpec = await fixLayoutIssues(spec, debugReport);
    return generatePresentation({ ...input, spec: fixedSpec });
  }
  
  // 7. ìµœì¢… ë Œë”ë§
  const outputPath = await render(spec, layout);
  
  // 8. ìŠ¤í™ ì €ì¥ (ì¬í˜„ ê°€ëŠ¥)
  await saveSpec(spec, `${outputPath}.spec.json`);
  
  return outputPath;
}
```

---

## ğŸ“Š MCP ì‚¬ìš© í†µê³„ ëŒ€ì‹œë³´ë“œ

```typescript
// MCP ë„êµ¬ ì‚¬ìš© ëª¨ë‹ˆí„°ë§
interface MCPUsageStats {
  sequenceThinking: {
    calls: number;
    avgDuration: number;
    successRate: number;
  };
  context7: {
    queries: number;
    cacheHits: number;
    cacheMisses: number;
  };
  github: {
    reads: number;
    writes: number;
    lastSync: string;
  };
  chromeDevTools: {
    inspections: number;
    issuesFound: number;
    issuesFixed: number;
  };
}
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **Sequence Thinking**: í† í° ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ í•„ìš”
2. **Context7**: ìºì‹œ ë§Œë£Œ ì‹œê°„ ì„¤ì • (API ë²„ì „ ë³€ê²½ ëŒ€ë¹„)
3. **GitHub**: ë ˆì´íŠ¸ ë¦¬ë°‹ ê³ ë ¤í•˜ì—¬ ë°°ì¹˜ ì²˜ë¦¬
4. **Chrome DevTools**: í—¤ë“œë¦¬ìŠ¤ ëª¨ë“œì—ì„œ ì¼ë¶€ ê¸°ëŠ¥ ì œí•œ
